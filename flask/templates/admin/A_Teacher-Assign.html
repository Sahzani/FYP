<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>iAttend - Assign Modules to Teachers</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
  *{margin:0;padding:0;box-sizing:border-box;}
  html,body{height:100%;font-family:'Poppins',sans-serif;background:linear-gradient(75.18deg,#FFE5B4 36.63%,#F5EEDC 92.2%);}
  header{position:fixed;top:0;left:0;right:0;height:60px;background:#fff;box-shadow:0 2px 20px rgba(1,41,112,0.1);display:flex;align-items:center;padding:0 20px;font-family:'Nunito',sans-serif;font-weight:700;font-size:26px;color:#212529;z-index:1002;}
  #menu-toggle{font-size:28px;margin-right:15px;cursor:pointer;}
  .header-content{width:100%;display:flex;justify-content:space-between;align-items:center;}
  .user-info{display:flex;align-items:center;gap:15px;padding:0 20px;border-radius:8px;cursor:pointer;}
  .user-info img{width:36px;height:36px;border-radius:50%;object-fit:cover;}
  .user-info span{font-size:16px;font-weight:600;color:#444;}
  .sidebar{position:fixed;top:0;left:0;width:240px;height:100%;background:linear-gradient(180deg,#FFEED3 0%,#FFEED3 100%);padding-top:60px;transition: width 0.4s;overflow-y:auto;box-shadow:2px 0 15px rgba(1,41,112,0.08);border-radius:0 16px 16px 0;}
  .sidebar.collapsed{width:70px;}
  .sidebar-section{margin-bottom:25px;}
  .sidebar-link{display:flex;align-items:center;gap:12px;padding:12px 20px;margin-bottom:5px;border-radius:8px;font-size:15px;font-weight:500;color:#1A237E;text-decoration:none;white-space:nowrap;}
  .sidebar-link.active{background:rgba(255,255,255,0.7);color:#4154F1;font-weight:600;}
  .main-content{margin-left:260px;padding:100px 30px 30px;height:100vh;overflow-y:auto;transition:margin-left 0.4s;}
  .sidebar.collapsed ~ .main-content{margin-left:80px;}
  .card{background:#fff;padding:1.5rem;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,0.08);margin-bottom:20px;transition: all 0.3s ease;}
  .card:hover{transform: translateY(-3px); box-shadow:0 12px 25px rgba(0,0,0,0.12);}
  table{width:100%;border-collapse:collapse;font-size:14px;}
  th{background-color:#f8f7ff;text-align:left;padding:12px;font-weight:500;color:#000;}
  td{padding:12px;border-top:1px solid #ddd;}
  tbody tr{transition: all 0.2s ease;}
  tbody tr:hover{background-color: #f5f7ff;box-shadow: 0 4px 20px rgba(0,0,0,0.08);transform: translateY(-2px);border-radius: 8px;}
  select,input{padding:8px 10px;border-radius:8px;border:1px solid #ccc;font-size:14px;width:100%;}
  button.action-btn{padding:8px 14px;border:none;border-radius:8px;cursor:pointer;color:white;font-weight:600;transition:0.3s;}
  button.save-btn{background:#1e90ff;}
  button.save-btn:hover{background:#1565c0;}
</style>
</head>
<body>

<header>
  <span id="menu-toggle">&#9776;</span>
  <div class="header-content">
    <span>iAttend Admin</span>
    <div class="user-info">
      <span>Admin</span>
      <img src="https://placehold.co/36x36/899BBD/ffffff?text=A" alt="Admin Profile">
    </div>
  </div>
</header>

<div class="sidebar">
  <div class="sidebar-section">
    <a class="sidebar-link" href="#"><i class="fas fa-home"></i><span>Dashboard</span></a>
  </div>
  <div class="sidebar-section">
    <a class="sidebar-link active" href="#"><i class="fas fa-chalkboard-teacher"></i><span>Assign Modules</span></a>
  </div>
</div>

<div class="main-content">
  <h2>Assign Modules to Teachers</h2>

  <div class="card">
    <table>
      <thead>
        <tr>
          <th>Teacher Name</th>
          <th>Email</th>
          <th>Program</th>
          <th>Group Code</th>
          <th>Assign Module</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        {% for teacher in teachers %}
        <tr>
          <td>{{ teacher.firstName }} {{ teacher.lastName }}</td>
          <td>{{ teacher.email }}</td>
          <td>
            {% if teacher.program %}
              {{ programs_map.get(teacher.program, 'N/A') }}
            {% else %}
              N/A
            {% endif %}
          </td>

          <form method="POST" action="{{ url_for('admin_teacher_assign') }}">
          <td>
            <input type="hidden" name="teacher_id" value="{{ teacher.docId }}">
            <select name="group_id" required>
              <option value="">Select Group</option>
              {% if teacher.program %}
                {% for group in groups %}
                  {% if group.fk_program and group.fk_program.strip() == teacher.program.strip() %}
                    <option value="{{ group.docId }}">{{ group.groupCode }}{% if group.intake %} - {{ group.intake }}{% endif %}</option>
                  {% endif %}
                {% endfor %}
              {% endif %}
            </select>
          </td>

          <td>
            <select name="module_id" required>
              <option value="">Select Module</option>
              {% for module in modules %}
                {% if module.status != 'assigned' %}
                  <option value="{{ module.docId }}">{{ module.moduleName }} ({{ module.moduleCode }})</option>
                {% endif %}
              {% endfor %}
            </select>
          </td>

          <td>
            <button type="submit" class="action-btn save-btn">Save</button>
          </td>
          </form>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

</body>
</html>
