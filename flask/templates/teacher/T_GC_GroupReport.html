<!-- T_GC_GroupReport.html -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>iAttend | Group Report</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">

<style>
body { margin: 0; font-family: 'Poppins', sans-serif; background-color: #fdfcfb; }
.user-info span { font-size: 16px; font-weight: 600; color: #444; }
.sidebar.collapsed .sidebar-section-title { opacity: 0; }
.main-content { margin-left: 260px; padding: 100px 30px 30px; min-height: 100vh; transition: margin-left 0.3s ease; }
.sidebar.collapsed ~ .main-content { margin-left: 80px; }
.main-content h2 { font-family: 'Poppins', sans-serif; font-size: 28px; font-weight: 700; color: #444; margin-bottom: 10px; }
.breadcrumb { font-family: 'Poppins', sans-serif; font-size: 14px; font-weight: 500; margin-bottom: 20px; }
.breadcrumb .section { color: #989797; }
.breadcrumb .current { color: #4154F1; font-weight: 400; }
.card { background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); margin-bottom: 20px; transition: transform 0.2s, box-shadow 0.2s; }
.card:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,0,0,0.15); }
label { font-weight: 500; font-size: 14px; margin-right: 10px; }
select { padding: 8px 10px; border-radius: 8px; border: 1px solid #d1d5db; font-size: 14px; margin-right: 10px; outline: none; transition: border-color 0.2s; }
select:focus { border-color: #6366f1; box-shadow: 0 0 0 2px rgba(99,102,241,0.2); }
button { padding: 8px 18px; background: #4154F1; color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: background 0.2s; }
button:hover { background: #2e3bbd; }
table { width: 100%; border-collapse: separate; border-spacing: 0; table-layout: fixed; }
table thead th { font-weight: 600; font-size: 14px; color: #2C2C2C; background-color: #f8f1e5; padding: 12px; text-align: center; position: sticky; top: 0; z-index: 10; }
table tbody td { padding: 10px 12px; border-top: 1px solid #e0e0e0; word-wrap: break-word; text-align: center; }
table tbody tr:hover { background: #fef9f0; transition: background 0.2s; }
.btn-export { display: inline-block; background-color: #ef4444; color: white; padding: 6px 14px; border-radius: 8px; font-size: 14px; text-decoration: none; margin-top: 10px; transition: 0.2s; }
.btn-export:hover { background-color: #dc2626; }
</style>
</head>

<body>
<header>
  <span id="menu-toggle">&#9776;</span>
  <div class="header-content">
    <a href="{{ url_for('teacher_dashboard') }}" class="title">iAttend</a>
    <a href="{{ url_for('teacher_profile') }}" class="user-info">
      <span>{{ profile.firstName }} {{ profile.lastName }}</span>
      <img src="{% if profile.photo_name and profile.photo_name.startswith('http') %}{{ profile.photo_name }}{% else %}{{ url_for('static', filename=profile.photo_name) }}{% endif %}" alt="Teacher Profile">
    </a>
  </div>
</header>

<div class="sidebar">
  <div class="sidebar-section">
    <a class="sidebar-link" href="{{ url_for('teacher_dashboard') }}">
      <i class="fas fa-home"></i><span>Dashboard</span>
    </a>
  </div>
  <div class="sidebar-section">
    <div class="sidebar-section-title">Reports</div>
    <a class="sidebar-link" href="{{ url_for('teacher_attendance') }}">
      <i class="fas fa-chart-bar"></i><span>Attendance Report</span>
    </a>
  </div>
  <div class="sidebar-section">
    <div class="sidebar-section-title">Manage</div>
    <a class="sidebar-link" href="{{ url_for('teacher_schedules') }}">
      <i class="fas fa-calendar"></i><span>Class Schedule</span>
    </a>
    <a class="sidebar-link" href="{{ url_for('teacher_modules') }}">
      <i class="fas fa-book"></i><span>My Modules & Groups</span>
    </a>
    <a class="sidebar-link" href="{{ url_for('teacher_manage_absent') }}">
      <i class="fas fa-calendar-alt"></i><span>Absences Application</span>
    </a>
    <a class="sidebar-link" href="{{ url_for('teacher_individual_summary') }}">
      <i class="fas fa-address-card"></i><span>Individual Attendance</span>
    </a>
  </div>

  {% if profile.is_gc %}
  <div class="sidebar-section">
    <div class="sidebar-section-title">Group Coordinator</div>
    <a class="sidebar-link" href="{{ url_for('gc_manage_group') }}">
      <i class="fas fa-users-cog"></i><span>Manage Group</span>
    </a>
    <a class="sidebar-link active" href="{{ url_for('gc_group_report') }}">
      <i class="fas fa-file-alt"></i><span>Group Report</span>
    </a>
  </div>
  {% endif %}

  <div class="sidebar-section">
    <a class="sidebar-link" href="{{ url_for('teacher_logout') }}">
      <i class="fas fa-sign-out-alt"></i><span>Logout</span>
    </a>
  </div>
</div>

<div class="main-content">
  <h2>Group Report</h2>
  <div class="breadcrumb"><span class="section">Group Coordinator</span> / <span class="current">Group Report</span></div>

  <div class="card">
    <form action="{{ url_for('gc_group_report') }}" method="POST">
      <label>Select Month:</label>
      <select name="report_month">
        {% for num, name in [(1,'January'),(2,'February'),(3,'March'),(4,'April'),(5,'May'),(6,'June'),(7,'July'),(8,'August'),(9,'September'),(10,'October'),(11,'November'),(12,'December')] %}
        <option value="{{ num }}" {% if num == current_month %}selected{% endif %}>{{ name }}</option>
        {% endfor %}
      </select>

      <label>Select Year:</label>
      <select name="report_year">
        {% for year in range(2000, 2101) %}
        <option value="{{ year }}" {% if year == current_year %}selected{% endif %}>{{ year }}</option>
        {% endfor %}
      </select>

      <button type="submit"><i class="fas fa-chart-line"></i> Generate Report</button>
    </form>
  </div>

  {% if report_data %}
  <div class="card">
    <h3 style="font-weight:600;color:#444;margin-bottom:10px;">Report Results</h3>
    <table>
      <thead>
        <tr>
          <th>Group</th>
          <th>Total Students</th>
          <th>Total Days</th>
          <th>Present</th>
          <th>Absent</th>
          <th>Overall Attendance (%)</th>
        </tr>
      </thead>
      <tbody>
        {% for row in report_data %}
        <tr>
          <td>{{ row.group }}</td>
          <td>{{ row.total_students }}</td>
          <td>{{ row.total_days }}</td>
          <td>{{ row.present }}</td>
          <td>{{ row.absent }}</td>
          <td>{{ row.overall_percentage }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <!-- Optional export button outside table -->
    <a href="{{ url_for('gc_export_pdf', month=selected_month, year=selected_year) }}" class="btn-export">
      <i class="fas fa-file-pdf"></i> Export PDF
    </a>
  </div>
  {% endif %}
</div>

<script>
const menuToggle = document.getElementById('menu-toggle');
const sidebar = document.querySelector('.sidebar');
menuToggle.addEventListener('click', () => { sidebar.classList.toggle('collapsed'); });
</script>

</body>
</html>
